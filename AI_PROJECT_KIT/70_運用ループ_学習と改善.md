# 運用ループ（学習と改善）

目的：AIが“自走に近い”状態で品質を上げ続けられるように、**学習→ルール更新**を運用に組み込む。

結論：完全自律で勝手に改善させるのは危険。**AIは提案・自動化、人間が承認**が安全で速い。

## 推奨ループ（毎PRで回す最小形）

### 1) PR前（AIに計画を書かせる）

- 影響範囲
- リスク
- 検証（コマンド）
- ロールバック

### 2) PR中（AIセルフレビュー→人間レビュー）

- AIセルフレビュー（`50_チェックリスト.md` の観点）
- 人間が重要箇所だけ確認

### 3) PR後（学びを“文書に固定”する）

- うまくいった：プロンプト/ルールを `100_プロンプト改善ログ.md` に追記
- 事故った：再発防止を `60_禁止事項と安全運用.md` または `10_AI指示書_プロジェクト雛形.md` に追記
- 判断が分かれた：`90_決定ログ_ADR.md` に決定理由を記録

## AIに「ルール更新案」を作らせる定型プロンプト

```text
このPR/作業で得た学びを、再発防止・再利用のために文書化したい。

材料：
- PRの要点：<要点>
- つまずき：<何が起きた>
- 修正：<どう直した>

お願い：
1) 今後AIが守るべきルール（短い箇条書き）を5〜10個にまとめて
2) どのファイルに追記すべきか提案して（10/60/100/90）
3) 追記案の文章をそのまま貼れる形で出して
```

## 「自走に近づける」ためのガードレール設計

- **自動化して良い領域（AIに任せやすい）**
  - 影響範囲の列挙
  - 小さな実装
  - テスト追加
  - lint/typecheck/test の失敗修正
  - PR本文作成

- **承認が必要な領域（人間が握る）**
  - 仕様の確定（曖昧さの解消）
  - 破壊的変更（削除/移行/互換性破壊）
  - セキュリティ/プライバシー/認可
  - 依存関係の大きな追加
  - 本番反映

