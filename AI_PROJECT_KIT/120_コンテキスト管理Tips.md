# コンテキスト管理Tips（最新2025）

目的：AIのコンテキストウィンドウは有限。**情報の"密度"を上げて、無駄を減らす**と品質が上がる。

## 1. 常駐コンテキスト（毎回渡す）は最小に

- **指示書（10_AI指示書）は短く**：500行以下が目安
- プロジェクト全体を渡さない。**今タスクに必要なファイルだけ**渡す
- 構造は「概要→規約→コマンド→参照先」の順で書く

## 2. 補助ドキュメントは @参照

- 毎回要らない仕様書は `docs/` に置き、必要なときだけ `@docs/xxx.md` で呼ぶ
- 呼ぶタイミングは Task Brief に書く

## 3. 大きなファイルは"要約＋差分"で渡す

- 1000行超のファイルを丸ごと渡すと精度が落ちる
- 代わりに：
  - `gitingest` 等で構造サマリを生成
  - 変更箇所の前後30行だけ渡す
  - 「この関数だけ」と範囲を限定

## 4. 記憶の階層（Claude Code / Cursor等共通）

| レベル | 例 | 更新頻度 |
|--------|-----|--------|
| グローバル | `~/.claude/CLAUDE.md` / ユーザー設定 | 月1 |
| プロジェクト | `./CLAUDE.md` / `.cursor/rules` | PR単位 |
| タスク | Task Brief / チャット | 毎タスク |
| セッション | 一時メモ | 使い捨て |

## 5. コンテキストリセットのタイミング

- 話が長くなって"ズレ"始めたら新規セッション
- リセット時は「Task Brief + 指示書 + 必要ファイル」のみ渡し直す

## 6. 便利プロンプト

### 要約を作らせる

```text
このファイル群の構造と主要関数を、100行以内の要約で出して。
後のセッションで参照しやすいようにまとめて。
```

### セッション開始時

```text
まず 10_AI指示書_プロジェクト雛形.md を読んで、このプロジェクトのルールを把握して。
その後、今回のTask Briefに入ります。
```

